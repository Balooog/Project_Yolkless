# PX-019.0 — Sandbox Visual Integration (Overview)

## Summary
PX-019 integrates the **Sandbox environment visuals** into the same stable viewport used by the HUD baseline (PX-018).  It standardizes world → camera → HUD layering so headless and interactive builds produce deterministic frames suitable for CI.

---

## Goals
- Unify the **EnvironmentStage** render path with the HUD viewport.
- Lock camera framing, safe-area margins, and z-ordering.
- Prove **driver parity** (Vulkan/Lavapipe ↔ OpenGL/llvmpipe via Xvfb).
- Establish **determinism** gates for CI (frame hash/RMS, tick thresholds).

---

## Deliverables
- Scene graph layout and layer contract.
- Camera calibration & safe-area alignment.
- Headless capture harness and CI hooks.
- Tick/telemetry thresholds for replay validation.

---

## Scope (19.x)
- **19.1 Sandbox Viewport Integration** — final scene tree, drivers, camera, acceptance tests.  
- **19.2 Environment Tick & Performance Validation** — timing targets and replay CI gates.

**Out of scope:** Economy/Conveyor GUI wiring, tooltips, panels (deferred to PX-020).

---

## Dependencies
- PX-018 HUD Baseline spec and images.  
- `EnvironmentStage_Backyard.tscn` and associated assets.  
- Headless capture pipeline (`tools/run_headless_godot.sh`).

---

## Results
- World and HUD share a single 1280×720 viewport with 32 px side / 24 px top safe-area margins.  
- Headless captures are deterministic under Vulkan (Lavapipe) and acceptable under OpenGL (llvmpipe).  
- CI enforces **no-toast/no-tooltip** baselines and validates replay ticks against thresholds.

---

## Next Phase
PX-020 builds on the unified viewport to expose Economy and Conveyor signals in the HUD (slots D/F), add the Automation panel, and extend telemetry.

---

## Cross-Links
- [PX-019.1 Sandbox Viewport](PX-019.1_Sandbox_Viewport.md)  
- [PX-019.2 Environment Tick Validation](PX-019.2_Environment_Tick_Validation.md)  
- [PX-018 HUD Baseline / Power Warnings](../px/PX-018.0_Overview.md) *(if available)*  
- [UI Baseline Layout Spec](../ui_baselines/README_UI_BASELINE_LAYOUT.md)

---

_Last updated {{ site.time | date: "%Y-%m-%d %H:%M UTC" }}_
