# PX-016.2 - Event and Risk Loop Implementation
**Targets:** RM-016  
**Status:** In Progress  
**Owner:** Solo Dev

## Scope
Create the weighted event scheduler that introduces calm production perturbations and logs them for telemetry and risk tracking.

## Objectives
1. Build an event table with weighted random selection, cooldowns, and blocking rules.
2. Implement event payloads for feed surplus, belt jam, and solar flare scenarios.
3. Provide HUD and audio feedback that respects accessibility settings.
4. Emit telemetry entries and update the risk register when new events land.

## Dependencies
- Layout and power integration (PX-019.1, PX-018.3).
- Automation telemetry (PX-013.2).

## Deliverables
- EventDirector scripts with scheduling logic.
- HUD overlays and notifications.
- Telemetry schema additions for event start, end, and impact.
- Risk register updates documenting mitigation triggers.

### Implementation Snapshot (Nov 2025 MVP)
- `SandboxService` now instantiates `EventEngine`, evaluates calm cadence gates, and emits `event_started/accepted/declined/completed` so UI + telemetry can react without bespoke polling.
- Data-first scaffolding (`src/events/EventRegistry.gd`, `src/events/EventEngine.gd`) holds the `overcast_day` and `bulk_order` definitions, effect opcodes, and toast metadata so future PX beats can expand the table without touching HUD code.
- HUD copy has been refreshed to match the calm system-feedback tone (new toast + tooltip strings), and the Micro-Event card now supports contextual buttons (acknowledge vs. accept/decline) plus tint metadata per event. `Main.gd` listens for SandboxService signals and relays accept/decline back into the engine.
- StatBus gained `micro_event_id` (owned by SandboxService) and StatsProbe mirrors each transition into `user://logs/perf/event_log.csv`, logging `event_id/kind/ts` for telemetry review.
- Events currently focus on environmental storytelling and telemetry plumbing; extend the table (PX-016.3) before adding heavier systemic modifiers or additional HUD overlays.

## Acceptance Criteria
1. Events trigger within configured cadence and never overlap when marked exclusive.
2. HUD shows clear but calm messaging for each event and clears after expiration.
3. Telemetry logs include event type, duration, and production delta.
4. CI replay can inject events deterministically for regression testing.
