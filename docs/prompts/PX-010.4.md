# PX-010.4 — Layout & Responsiveness Pass
**Targets:** RM-010 — UI & Control Architecture  
**Branch:** `feature/RM-010-layout-pass`  
**Status:** Planned

## 1. Scope
Normalize layout containers, breakpoints, and safe-area handling across the prototype HUD. Remove ad-hoc margins in favour of container hierarchy and ensure deterministic layout at S/M/L widths.

## 2. Objectives
1. Replace free-floating controls with container-based layout (`VBoxContainer`, `HBoxContainer`, `GridContainer`, `MarginContainer`) respecting guardrail sizing policies.
2. Implement responsive breakpoint logic (S < 720, M 720–1199, L ≥ 1200) in `UIArchitecturePrototype.gd`, adjusting token-driven spacing, banner height, and sheet placement.
3. Honour safe-area padding: reserve bottom 96 px for the feed button on mobile, keep top banner unobstructed.
4. Remove hard-coded offsets; use `size_flags` and `custom_minimum_size` per container guidelines.

## 3. Deliverables
- Updated `scenes/prototype/ui_architecture.tscn` structure and `UIArchitecturePrototype.gd`.
- New helper functions in `UIHelpers.gd` (`apply_safe_area`, `set_size_policy`).
- Viewport sweeper script `tools/ui_viewport_matrix.sh` to iterate resolutions and capture screenshots (integrating with PX-010.9 later).
- Documentation additions: breakpoint table in `docs/ux/UI_Principles.md`.

## 4. Acceptance Criteria
1. HUD renders without overflow at 640×360, 1280×720, and 1920×1080; screenshots show matching alignment per spec.
2. Feed button region remains unobstructed at S breakpoint; safe-area padding applied.
3. Containers declare appropriate `size_flags`; no direct children of `CanvasLayer` except top-level containers.
4. CI viewport matrix script exits successfully and produces screenshots for comparison.

## 5. Tests & Validation
- Run `tools/ui_viewport_matrix.sh` (Godot headless) to capture baseline at target resolutions.
- Manual verification: check `UIHelpers` ensures `clip_text` or `autowrap` on configured nodes.

## 6. Dependencies
- Builds on PX-010.3 token system.
- Prepares ground for PX-010.5+ (banner, tabs, sheets hardening).

## 7. Rollback Plan
- Restore previous scene layout and remove safe-area helpers; keep token system intact.

## 8. Footers
```
RM: RM-010
PX: PX-010.4
```
