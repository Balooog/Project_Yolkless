# PX-009.1 — Conveyor Belt Visual Module
**Targets:** RM-009  
**Date:** 2025-10-22  
**Outcome:** In Progress

## Driver Prompt
# Project Yolkless – PX-009.1  
### Conveyor Belt Visual Module (Targets RM-009)

---

## 1. Scope
Develop the **Conveyor Belt Visual Module** to simulate item transport, accumulation, and flow rate within Yolkless’s core game loop.  
The module serves both **visual feedback** (animated motion of items) and **logical throughput tracking** (production rate, queueing, capacity limits).

---

## 2. Functional Objectives
1. **Item Representation**
   - Render discrete items (eggs, yolks, crates, etc.) as sprites or lightweight mesh entities.  
   - Each carries metadata: `item_id`, `type`, `spawn_time`, `speed`, and `state` (moving, queued, processed).

2. **Conveyor Path**
   - Modular spline or segment system (`ConveyorSegment`) allowing chaining of straight and curved runs.  
   - Each segment defines: `length`, `speed`, and `capacity`.  
   - Supports bidirectional orientation for future factory loops.

3. **Motion Logic**
   - Continuous update based on delta time; objects advance along normalized spline position.  
   - If next segment is full, item halts at junction and visually queues.  
   - Smooth easing transitions when starting/stopping.

4. **Throughput Metrics**
   - Maintain live stats: items/sec, items queued, average travel time.  
   - Expose as signals/events to the global simulation manager.

5. **Visual Layer**
   - Conveyor belt texture scrolling at proportional rate to motion speed.  
   - Optional belt tint or highlight to indicate upgrade tier or overload.  
   - Adjustable camera zoom and pan integration.

6. **Integration Hooks**
   - Input: `spawn_item(item_type)` from producer modules.  
   - Output: `deliver_item()` to next station (e.g., Packager or Cracker modules).  
   - Event hooks for animation triggers or FX (spark, jam, overflow).

7. **Performance Targets**
   - Maintain ≥60 FPS with up to 500 concurrent moving items.  
   - All updates run within ≤2 ms frame budget on mid-tier hardware.

---

## 3. Architecture Notes
- **Engine:** Godot 4.x (GDScript or C# layer per repo standard).  
- **Core Classes:**  
  - `ConveyorBelt.gd` – handles belt visuals and item slots.  
  - `ConveyorItem.gd` – manages per-item state and interpolation.  
  - `ConveyorManager.gd` – oversees linking, metrics, and signaling.  
- **Signals:**  
  - `item_spawned(item_id)`  
  - `item_delivered(item_id, destination)`  
  - `throughput_updated(rate, queue_len)`

---

## 4. Acceptance Criteria
1. Items visually travel along belt paths with smooth, frame-synced motion.  
2. Queued items visibly accumulate when downstream segments are full.  
3. Belt scroll texture reflects conveyor speed.  
4. Throughput metrics update in real-time and log to console or HUD overlay.  
5. Handles dynamic addition/removal of belt segments without crash.  
6. Meets target performance metrics.

---

## 5. Deliverables
- `/src/modules/conveyor/ConveyorBelt.gd`  
- `/src/modules/conveyor/ConveyorItem.gd`  
- `/src/modules/conveyor/ConveyorManager.gd`  
- Demo scene: `/scenes/demo_conveyor.tscn` showcasing item spawning, queuing, and delivery.  
- Updated README section under `docs/modules/conveyor.md` describing usage and integration.

---

## 6. Future Extensions
- Branch/junction logic (splitters/mergers).  
- Power-based speed modulation system.  
- Conveyor skin themes tied to factory tier progression.  
- Physics interaction for special events (spill, jam).

---

**Linked Roadmap:** RM-009 – Core Conveyor Mechanics  
**Branch Convention:** `feature/RM-009-conveyor-belt`  
**Parent Epic:** Factory Automation Visual Layer

## Deliverables
- Pending

## Validation
- Pending
