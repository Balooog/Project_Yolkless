# PX-010.12 — UI Performance & GC Audit
**Targets:** RM-010 — UI & Control Architecture  
**Branch:** `feature/RM-010-ui-performance`  
**Status:** Planned

## 1. Scope
Ensure the expanded UI stack respects performance budgets by reducing allocations, pooling elements, and throttling high-frequency updates.

## 2. Objectives
1. Profile UI interactions to identify allocations; pool list items and pre-load DynamicFont resources to avoid runtime spikes.
2. Throttle metric updates (credits, PPS, tooltips) to 5 Hz where visual fidelity allows, using token-driven easing.
3. Integrate UI metrics into StatsProbe: `ui_frame_ms_avg`, `ui_frame_ms_p95`, `ui_alloc_bytes`.
4. Validate garbage collection (GC) spikes stay under 2 ms during sheet open/close, store scrolling, and tooltip bursts.

## 3. Deliverables
- Updated UI scripts implementing throttling and pooling.
- StatsProbe hooks for UI performance telemetry.
- Documentation: add UI performance targets to `docs/quality/Performance_Budgets.md` and mention GC expectations in `docs/ux/UI_Principles.md`.
- Optional logging toggle to print UI allocation deltas in dev builds.

## 4. Acceptance Criteria
1. Profiling session (StatsProbe + Godot profiler) shows p95 frame cost unchanged or lower compared to baseline.
2. GC spikes remain < 2 ms during stress scenario (sheet spam, tooltip spam).
3. UI metrics appear in telemetry replay CSV/JSON.
4. UILint remains green; no regressions introduced by pooling/throttling.

## 5. Tests & Validation
- Run `tools/ui_viewport_matrix.sh` with stress scenario to ensure consistent metrics.
- Review StatsProbe logs for UI entries; confirm thresholds and absence of alerts.

## 6. Dependencies
- Builds on completed component system and tooltip/dialog features.
- Completes RM-010 parity goals before post-RM polish.

## 7. Rollback Plan
- Disable throttling/pooling modules; remove StatsProbe UI metrics to return to prior behaviour.

## 8. Footers
```
RM: RM-010
PX: PX-010.12
```
