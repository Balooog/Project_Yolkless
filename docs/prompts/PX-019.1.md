# PX-019.1 — Factory Layout System
**Targets:** RM-019  
**Date:** 2025-10-22  
**Outcome:** Planned

## Driver Prompt
# Project Yolkless – PX-019.1  
### Factory Layout System (Targets RM-019)

---

## 1. Scope
Create a grid-based placement system for factory structures, supporting adjacency bonuses, power/resource integration, and automation hooks.

## 2. Functional Objectives
1. **Grid Framework**
   - Tile map data structure with buildable layers.
   - Handles placement, removal, and rotation.
2. **Building Definitions**
   - Data-driven entries for cost, power, adjacency effects.
   - Support categories: Coop, Conveyor, Auto-Feeder, Power Plant, Research Node.
3. **Adjacency Bonuses**
   - Calculate modifiers based on neighboring tiles.
   - Feed results into economy metrics.
4. **UX & Feedback**
   - Placement previews, valid/invalid indicators, power impact display.
5. **Persistence**
   - Save/load layout state with integrity checks.

## 3. Architecture Notes
- Introduce `FactoryGrid.gd` managing tile occupancy and signals.
- Define `BuildingBlueprint` resources for metadata.
- Hook into automation (RM-013) and power service (RM-018) for runtime updates.
- Provide editor tools or debug commands for quick layout changes.
- Integrate with UI canvas defined in RM-010.

## 4. Acceptance Criteria
1. Players can place/move/remove buildings with cost and power validation.
2. Adjacency bonuses apply immediately and update economy stats.
3. Visual cues communicate placement rules and effects.
4. Layout state persists across sessions without corruption.
5. Telemetry logs placement actions for QA review.

## 5. Deliverables
- `src/factory/FactoryGrid.gd` and related scripts.
- Building blueprint resources in `data/buildings/` (migrate from `game/data/buildings/`).
- UI scenes for placement controls and overlays.
- Documentation updates in `/docs/roadmap/RM-019.md`.
- Test scenarios validating adjacency and power interactions.

## 6. Future Extensions
- Multi-floor or multi-zone layouts.
- Player-crafted templates/blueprints.
- Dynamic terrain modifiers affecting placement.

**Linked Roadmap:** RM-019 – Factory Layout System  
**Branch Convention:** `feature/RM-019-factory-layout`  
**Parent Epic:** Factory Expansion
