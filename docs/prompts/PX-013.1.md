# PX-013.1 — Automation Core
**Targets:** RM-013  
**Date:** 2025-10-22  
**Outcome:** Planned

## Driver Prompt
# Project Yolkless – PX-013.1  
### Automation Core (Targets RM-013)

---

## 1. Scope
Implement the automation layer governing Auto-Feeders, conveyors, and future buildings. Provide manual, global, and per-building automation controls with power-aware decision making. Automation cadence must respect the comfort-idle boundaries in `docs/analysis/IdleGameComparative.md` so hands-off play still feels tranquil.

## 2. Functional Objectives
1. **Automation Director**
   - Central scheduler running per economy tick.
   - Manages registered automatable entities.
2. **Mode Handling**
   - Support OFF / MANUAL / AUTO per building.
   - Global toggle to suspend or resume automation.
3. **Auto-Feeder System**
   - Automatically triggers feed bursts when supply thresholds met.
   - Respects power constraints and event modifiers.
4. **Conveyor Integration**
   - Coordinates belt speeds with automation state.
   - Responds to jams or events (RM-016).
5. **Telemetry & Debug**
   - Emit state changes to ShopDebug/automation overlay.
   - Provide diagnostics for QA simulations (RM-014).

## 3. Architecture Notes
- Introduce `AutomationService.gd` singleton with registration API.
- Define `Automatable` interface (signals: `mode_changed`, `tick(request)`, `power_demand`).
- Register the service with the 10 Hz `SimulationClock` spine so automation ticks between Environment/Sandbox and Economy (see `docs/architecture/Overview.md`).
- Store automation preferences in save data with migration guard.
- Expose inspector properties for testing in editor.

## 4. Acceptance Criteria
1. Automation director registers buildings and processes tick callbacks.
2. Auto-Feeder maintains target feed percentile without overspending.
3. Conveyors adjust throughput according to automation mode.
4. Power deficits (RM-018) force automation downgrades with messaging.
5. Manual overrides persist across sessions.

## 5. Deliverables
- `/src/services/AutomationService.gd`
- Updated building scripts implementing `Automatable`.
- HUD overlay scene showing automation modes.
- Documentation in `/docs/roadmap/RM-013.md`.
- Test scripts/simulations validating automation behaviors.

## 6. Future Extensions
- Scheduling priorities (e.g., energy-saving mode).
- Player-programmable automation sequences.
- Cross-factory automation when multi-zone power arrives.

**Linked Roadmap:** RM-013 – Automation Core  
**Branch Convention:** `feature/RM-013-automation`  
**Parent Epic:** Systems Automation Suite
