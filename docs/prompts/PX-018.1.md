# PX-018.1 — PowerService Core & Automation Conditioning
**Targets:** RM-018 — Power & Resource Layer  
**Date:** 2025-10-24  
**Outcome:** Planned  

## Scope
Build the power ledger and expose power ratio signals that influence automation cadence and UI.  Integrate EnvironmentService modifiers (light/temp) and provide human-readable warnings.

## Objectives
1. Track generation/consumption pools and compute `power_ratio` (0–1).  
2. Emit `power_state_changed(state: float)` every tick and `power_warning(level)` on threshold crossings (0.7, 0.4).  
3. Expose StatBus entry `power_state`; clamp to 0–1.3 with logging on clamp.  
4. Condition AutomationService tick rate: `tick_rate = base_rate * power_ratio`.  
5. Map Environment factors (light → solar boost, high heat → penalty) into the ledger.  
6. Add HUD `PowerIndicator` with tooltip and color states (green/yellow/red).  
7. Log power metrics into telemetry (replay JSON) for QA baselines.  

## Deliverables
- `/src/services/PowerService.gd` — ledger + signals.  
- `/ui/widgets/PowerIndicator.tscn` + script.  
- AutomationService updates to honour power ratio.  
- Telemetry hook updates (`replay_headless.gd`, `ci/econ_probe.gd`).  
- Documentation: `Signals_Events.md`, `StatBus_Catalog.md`, `Telemetry_Replay.md`, `Performance_Budgets.md`.  

## Validation
- When power ratio drops below 0.7, HUD indicator turns yellow; below 0.4, red with single warning log.  
- Automation auto-burst cadence visibly slows/speeds with power changes in a test scene.  
- Headless replay outputs `power_ratio` series; average matches manual calculations.  
- Profiler shows PowerService ≤ 0.8 ms per tick at 10 Hz.  
