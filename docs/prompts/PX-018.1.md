# PX-018.1 — Power & Resource Layer
**Targets:** RM-018  
**Date:** 2025-10-22  
**Outcome:** Planned

## Driver Prompt
# Project Yolkless – PX-018.1  
### Power & Resource Layer (Targets RM-018)

---

## 1. Scope
Implement an abstract power-capacity model for factory buildings, allowing the economy and automation systems to respond to energy surplus or deficit states.

## 2. Functional Objectives
1. **Power Ledger**
   - Track total production, consumption, and reserve capacity each tick.
2. **Building Integration**
   - Each structure provides `powerUse` and `powerState` descriptors.
   - Support power generators and consumers.
3. **UI Feedback**
   - Ambient tint or overlay reflects current power ratio.
   - Alerts when consumption exceeds production.
4. **System Hooks**
   - Automation throttles or pauses on power deficit.
   - Events can modify power for limited durations.
5. **Future-Proofing**
   - Scaffold multi-zone grid support without shipping it now.

## 3. Architecture Notes
- Add `PowerService.gd` managing the ledger and broadcasting state changes.
- Extend building base classes with power metadata (JSON/TSV definitions).
- Integrate power metrics into telemetry (RM-014).
- Drive visual effects via Environment/Lighting layers.
- Provide configuration for designers to tweak generation/consumption.

## 4. Acceptance Criteria
1. Power ledger updates deterministically and reflects building adds/removals.
2. UI accurately communicates surplus/deficit and recovery.
3. Automation reacts to power availability (e.g., downgrades to MANUAL).
4. Events (RM-016) can modify power and revert cleanly.
5. Save/load preserves power state without desyncs.

## 5. Deliverables
- `/src/services/PowerService.gd`.
- Updated building data entries with power metadata.
- UI overlays/lighting tweaks integrated in main scene.
- Telemetry outputs including power metrics.
- Documentation in `/docs/roadmap/RM-018.md`.

## 6. Future Extensions
- Zone-specific power grids and transmission lines.
- Battery/storage mechanics.
- Player upgrades affecting efficiency or capacity.

**Linked Roadmap:** RM-018 – Power & Resource Layer  
**Branch Convention:** `feature/RM-018-power`  
**Parent Epic:** Systems Infrastructure
